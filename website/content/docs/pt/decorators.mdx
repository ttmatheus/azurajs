---
title: Decorators
description: Guia completo de todos os decorators do AzuraJS
icon: Tag
---

# Decorators üè∑Ô∏è

AzuraJS fornece um rico conjunto de decorators TypeScript para construir APIs elegantes e type-safe.

## Refer√™ncia Completa de Decorators üìã

### Decorators de Classe

| Decorator | Prop√≥sito | Exemplo |
|-----------|----------|----------|
| `@Controller(prefix?)` | Define uma classe controller com caminho base opcional | `@Controller("/api/users")` |

### Decorators de M√©todo (Rotas HTTP)

| Decorator | M√©todo HTTP | Prop√≥sito | Exemplo |
|-----------|--------------|----------|----------|
| `@Get(path?)` | GET | Recuperar recursos | `@Get("/:id")` |
| `@Post(path?)` | POST | Criar recursos | `@Post("/create")` |
| `@Put(path?)` | PUT | Atualizar (completo) | `@Put("/:id")` |
| `@Patch(path?)` | PATCH | Atualizar (parcial) | `@Patch("/:id")` |
| `@Delete(path?)` | DELETE | Remover recursos | `@Delete("/:id")` |
| `@Head(path?)` | HEAD | Verificar exist√™ncia | `@Head("/:id")` |
| `@Options(path?)` | OPTIONS | Preflight CORS | `@Options()` |

### Decorators de Par√¢metro

| Decorator | Extrai | Tipo | Exemplo |
|-----------|--------|------|----------|
| `@Req()` | Objeto de requisi√ß√£o completo | `RequestServer` | `@Req() req: RequestServer` |
| `@Res()` | Objeto de resposta completo | `ResponseServer` | `@Res() res: ResponseServer` |
| `@Body(key?)` | Corpo da requisi√ß√£o | `any` | `@Body() data: CreateDto` |
| `@Param(key?)` | Par√¢metros de rota | `string` | `@Param("id") id: string` |
| `@Query(key?)` | Par√¢metros de query string | `string` | `@Query("page") page: string` |
| `@Headers(key?)` | Cabe√ßalhos HTTP | `string` | `@Headers("auth") token: string` |
| `@Ip()` | Endere√ßo IP do cliente | `string` | `@Ip() ip: string` |
| `@UserAgent()` | Cabe√ßalho User-Agent | `string` | `@UserAgent() ua: string` |
| `@Next()` | Fun√ß√£o next | `Function` | `@Next() next: () => void` |

<Callout type="info">
  Todos os decorators de par√¢metro podem ser combinados em um √∫nico m√©todo para extrair diferentes partes da requisi√ß√£o.
</Callout>

## Decorators de Classe üéØ

### @Controller

Define uma classe controller com um caminho base opcional.

```typescript
@Controller(prefix?: string)
```

**Exemplos:**

```typescript
import { Controller } from "azurajs/decorators";

// Com prefixo
@Controller("/api/users")
export class UserController {}

// Sem prefixo
@Controller()
export class RootController {}

// Caminho aninhado
@Controller("/api/v1/admin/users")
export class AdminUserController {}
```

## Decorators de M√©todo üõ£Ô∏è

Decorators de m√©todo definem rotas HTTP para m√©todos do controller.

### @Get

Define uma rota GET.

```typescript
@Get(path?: string)
```

**Exemplos:**

```typescript
import { Controller, Get } from "azurajs/decorators";

@Controller("/api/users")
export class UserController {
  @Get()  // GET /api/users
  getAll() {}

  @Get("/:id")  // GET /api/users/:id
  getOne() {}

  @Get("/search")  // GET /api/users/search
  search() {}
}
```

### @Post

Define uma rota POST.

```typescript
@Post(path?: string)
```

**Exemplo:**

```typescript
import { Post, Body } from "azurajs/decorators";

@Post()  // POST /api/users
createUser(@Body() data: any) {
  return { id: Date.now(), ...data };
}
```

### @Put

Define uma rota PUT para atualiza√ß√µes completas.

```typescript
@Put(path?: string)
```

**Exemplo:**

```typescript
@Put("/:id")  // PUT /api/users/:id
updateUser(@Param("id") id: string, @Body() data: any) {
  return { id, ...data };
}
```

### @Patch

Define uma rota PATCH para atualiza√ß√µes parciais.

```typescript
@Patch(path?: string)
```

**Exemplo:**

```typescript
@Patch("/:id")  // PATCH /api/users/:id
patchUser(@Param("id") id: string, @Body() data: Partial<User>) {
  return { id, ...data };
}
```

### @Delete

Define uma rota DELETE.

```typescript
@Delete(path?: string)
```

**Exemplo:**

```typescript
@Delete("/:id")  // DELETE /api/users/:id
deleteUser(@Param("id") id: string) {
  return { message: "Usu√°rio deletado" };
}
```

### @Head

Define uma rota HEAD (para verificar exist√™ncia de recurso).

```typescript
@Head(path?: string)
```

**Exemplo:**

```typescript
@Head("/:id")  // HEAD /api/users/:id
checkExists(@Param("id") id: string, @Res() res: ResponseServer) {
  const exists = users.some(u => u.id === id);
  res.status(exists ? 200 : 404).end();
}
```

### @Options

Define uma rota OPTIONS (tipicamente para preflight CORS).

```typescript
@Options(path?: string)
```

**Exemplo:**

```typescript
@Options()  // OPTIONS /api/users
handleOptions(@Res() res: ResponseServer) {
  res.set("Allow", "GET, POST, PUT, DELETE").end();
}
```

## Decorators de Par√¢metro üîñ

Decorators de par√¢metro injetam dados nos par√¢metros de m√©todos do controller.

### @Req

Injeta o objeto de requisi√ß√£o completo.

```typescript
@Req() req: RequestServer
```

**Exemplo:**

```typescript
@Get("/info")
getInfo(@Req() req: RequestServer) {
  return {
    method: req.method,
    url: req.url,
    headers: req.headers
  };
}
```

### @Res

Injeta o objeto de resposta para controle manual.

```typescript
@Res() res: ResponseServer
```

**Exemplo:**

```typescript
@Get("/download")
download(@Res() res: ResponseServer) {
  res.setHeader("Content-Type", "application/octet-stream");
  res.setHeader("Content-Disposition", "attachment; filename=arquivo.zip");
  res.send(fileBuffer);
}
```

### @Body

Extrai o corpo da requisi√ß√£o (automaticamente parseado para JSON e form data).

```typescript
@Body() body: any
```

**Exemplos:**

```typescript
// Corpo completo
@Post()
create(@Body() data: CreateUserDto) {
  return { id: Date.now(), ...data };
}

// Acessar propriedades do corpo diretamente
@Post()
create(@Body() { name, email }: { name: string; email: string }) {
  return { name, email };
}
```

### @Param

Extrai par√¢metros de rota do caminho da URL.

```typescript
@Param(name?: string) param: string
```

**Exemplos:**

```typescript
// Par√¢metro √∫nico
@Get("/:id")
getUser(@Param("id") id: string) {
  return { id };
}

// M√∫ltiplos par√¢metros
@Get("/:userId/posts/:postId")
getPost(
  @Param("userId") userId: string,
  @Param("postId") postId: string
) {
  return { userId, postId };
}

// Todos os par√¢metros
@Get("/:userId/posts/:postId")
getPost(@Param() params: Record<string, string>) {
  return params;  // { userId: "1", postId: "2" }
}
```

### @Query

Extrai par√¢metros de query string.

```typescript
@Query(name?: string) query: string
```

**Exemplos:**

```typescript
// Par√¢metro de query √∫nico
@Get("/search")
search(@Query("q") searchTerm: string) {
  return { results: [], query: searchTerm };
}

// M√∫ltiplos par√¢metros de query
@Get("/filter")
filter(
  @Query("status") status: string,
  @Query("limit") limit: string
) {
  return { status, limit };
}

// Todos os par√¢metros de query
@Get("/search")
search(@Query() query: Record<string, string>) {
  // GET /api/users/search?q=john&limit=10
  return query;  // { q: "john", limit: "10" }
}
```

### @Headers

Extrai cabe√ßalhos da requisi√ß√£o.

```typescript
@Headers(name?: string) header: string | undefined
```

**Exemplos:**

```typescript
// Cabe√ßalho √∫nico
@Get("/protected")
getData(@Headers("authorization") auth: string) {
  if (!auth) {
    throw new HttpError(401, "N√£o autorizado");
  }
  return { data: "secreto" };
}

// M√∫ltiplos cabe√ßalhos
@Get("/info")
getInfo(
  @Headers("user-agent") ua: string,
  @Headers("accept-language") lang: string
) {
  return { userAgent: ua, language: lang };
}

// Todos os cabe√ßalhos
@Get("/headers")
getAllHeaders(@Headers() headers: Record<string, string>) {
  return { headers };
}
```

### @Ip

Extrai o endere√ßo IP do cliente.

```typescript
@Ip() ip: string
```

**Exemplo:**

```typescript
@Post("/login")
login(@Body() credentials: any, @Ip() ip: string) {
  console.log(`Tentativa de login de ${ip}`);
  // Autenticar usu√°rio
  return { success: true };
}
```

### @UserAgent

Extrai o cabe√ßalho User-Agent.

```typescript
@UserAgent() userAgent: string
```

**Exemplo:**

```typescript
@Get("/stats")
trackVisit(@UserAgent() ua: string, @Ip() ip: string) {
  console.log(`Visita de ${ip} usando ${ua}`);
  return { message: "Visita registrada" };
}
```

### @Next

Injeta a fun√ß√£o next para cadeias de middleware.

```typescript
@Next() next: (err?: unknown) => void
```

**Exemplo:**

```typescript
@Get("/async")
async handleAsync(
  @Req() req: RequestServer,
  @Res() res: ResponseServer,
  @Next() next: () => void
) {
  try {
    const data = await fetchData();
    res.json({ data });
  } catch (error) {
    next(error);
  }
}
```

## Combinando Decorators üîó

Voc√™ pode combinar m√∫ltiplos decorators de par√¢metro em um m√©todo:

```typescript
@Controller("/api/posts")
export class PostController {
  @Get("/:id/comments")
  getComments(
    @Param("id") postId: string,
    @Query("limit") limit: string,
    @Query("offset") offset: string,
    @Headers("authorization") auth: string,
    @Ip() ip: string,
    @Res() res: ResponseServer
  ) {
    // Verificar autentica√ß√£o
    if (!auth) {
      return res.status(401).json({ error: "N√£o autorizado" });
    }

    // Registrar requisi√ß√£o
    console.log(`${ip} solicitou coment√°rios do post ${postId}`);

    // Retornar coment√°rios
    const comments = getCommentsFromDB(postId, Number(limit), Number(offset));
    res.json({ comments });
  }

  @Post("/:id/comments")
  createComment(
    @Param("id") postId: string,
    @Body() data: CreateCommentDto,
    @Ip() ip: string,
    @UserAgent() ua: string,
    @Res() res: ResponseServer
  ) {
    const comment = {
      id: Date.now(),
      postId,
      ...data,
      metadata: { ip, userAgent: ua }
    };

    res.status(201).json({ comment });
  }
}
```

## Ordem de Execu√ß√£o dos Decorators ‚ö°

Decorators s√£o executados nesta ordem:

1. **Decorator de Classe** (`@Controller`) - Registra o controller
2. **Decorators de M√©todo** (`@Get`, `@Post`, etc.) - Registra rotas
3. **Decorators de Par√¢metro** (`@Body`, `@Param`, etc.) - Executados em runtime quando a rota √© chamada

## Seguran√ßa de Tipos com Decorators üîí

Use interfaces TypeScript para melhor seguran√ßa de tipos:

```typescript
interface CreatePostDto {
  title: string;
  content: string;
  tags: string[];
}

interface UpdatePostDto {
  title?: string;
  content?: string;
  tags?: string[];
}

@Controller("/api/posts")
export class PostController {
  @Post()
  create(@Body() data: CreatePostDto, @Res() res: ResponseServer) {
    // data √© totalmente tipado
    const post = {
      id: Date.now(),
      title: data.title,
      content: data.content,
      tags: data.tags
    };
    res.status(201).json({ post });
  }

  @Patch("/:id")
  update(
    @Param("id") id: string,
    @Body() data: UpdatePostDto,
    @Res() res: ResponseServer
  ) {
    // TypeScript sabe que todos os campos s√£o opcionais
    res.json({ id, ...data });
  }
}
```

## Casos de Uso Avan√ßados üöÄ

### Autentica√ß√£o & Autoriza√ß√£o

```typescript
import { Controller, Get, Post, Headers, Body, Res } from "azurajs/decorators";

interface User {
  id: string;
  email: string;
  role: string;
}

@Controller("/api/admin")
export class AdminController {
  // M√©todo auxiliar para verificar token de admin
  private verifyAdmin(token: string): User {
    if (!token) {
      throw new HttpError(401, "Sem token de autoriza√ß√£o");
    }
    
    const user = verifyToken(token);
    
    if (user.role !== 'admin') {
      throw new HttpError(403, "Acesso de admin necess√°rio");
    }
    
    return user;
  }

  @Get("/users")
  listUsers(@Headers("authorization") auth: string) {
    const user = this.verifyAdmin(auth);
    return { users: getAllUsers() };
  }

  @Delete("/users/:id")
  deleteUser(
    @Param("id") id: string,
    @Headers("authorization") auth: string
  ) {
    const user = this.verifyAdmin(auth);
    deleteUserById(id);
    return { message: "Usu√°rio deletado" };
  }
}
```

### Padr√£o de Valida√ß√£o de Requisi√ß√£o

```typescript
import { Controller, Post, Body, Res } from "azurajs/decorators";

interface CreateUserDto {
  email: string;
  password: string;
  name: string;
  age?: number;
}

function validateEmail(email: string): boolean {
  return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
}

function validatePassword(password: string): boolean {
  return password.length >= 8;
}

@Controller("/api/users")
export class UserController {
  @Post("/register")
  register(@Body() data: CreateUserDto, @Res() res: ResponseServer) {
    // Validar email
    if (!validateEmail(data.email)) {
      return res.status(400).json({ 
        error: "Formato de email inv√°lido" 
      });
    }
    
    // Validar senha
    if (!validatePassword(data.password)) {
      return res.status(400).json({ 
        error: "Senha deve ter pelo menos 8 caracteres" 
      });
    }
    
    // Validar idade se fornecida
    if (data.age && (data.age < 13 || data.age > 120)) {
      return res.status(400).json({ 
        error: "Idade inv√°lida" 
      });
    }
    
    // Criar usu√°rio
    const user = createUser(data);
    return res.status(201).json({ user });
  }
}
```

### Upload de Arquivo com Metadados

```typescript
import { Controller, Post, Req, Headers, Ip, UserAgent, Res } from "azurajs/decorators";

@Controller("/api/files")
export class FileController {
  @Post("/upload")
  async uploadFile(
    @Req() req: RequestServer,
    @Headers("content-type") contentType: string,
    @Ip() ip: string,
    @UserAgent() userAgent: string,
    @Res() res: ResponseServer
  ) {
    // Validar tipo de conte√∫do
    if (!contentType?.includes('multipart/form-data')) {
      return res.status(400).json({ 
        error: "Deve usar multipart/form-data" 
      });
    }
    
    try {
      const files = await parseMultipartForm(req);
      
      // Salvar arquivos com metadados
      const savedFiles = files.map(file => ({
        id: generateId(),
        name: file.name,
        size: file.size,
        type: file.type,
        uploadedAt: new Date().toISOString(),
        uploadedFrom: ip,
        userAgent: userAgent
      }));
      
      return res.status(201).json({ 
        files: savedFiles 
      });
    } catch (error) {
      return res.status(500).json({ 
        error: "Falha no upload" 
      });
    }
  }
}
```

### Padr√£o de Rate Limiting

```typescript
import { Controller, Post, Ip, Res } from "azurajs/decorators";

const requestCounts = new Map<string, number[]>();

function checkRateLimit(ip: string, maxRequests: number, windowMs: number): boolean {
  const now = Date.now();
  const requests = requestCounts.get(ip) || [];
  
  // Filtrar requisi√ß√µes dentro da janela de tempo
  const recentRequests = requests.filter(time => now - time < windowMs);
  
  if (recentRequests.length >= maxRequests) {
    return false; // Limite excedido
  }
  
  // Adicionar requisi√ß√£o atual
  recentRequests.push(now);
  requestCounts.set(ip, recentRequests);
  
  return true; // Permitido
}

@Controller("/api/auth")
export class AuthController {
  @Post("/login")
  login(
    @Body() credentials: { email: string; password: string },
    @Ip() ip: string,
    @Res() res: ResponseServer
  ) {
    // Permitir m√°ximo 5 tentativas de login por 15 minutos
    if (!checkRateLimit(ip, 5, 15 * 60 * 1000)) {
      return res.status(429).json({
        error: "Muitas tentativas de login. Tente novamente mais tarde."
      });
    }
    
    // Autenticar usu√°rio
    const user = authenticateUser(credentials);
    
    if (!user) {
      return res.status(401).json({ 
        error: "Credenciais inv√°lidas" 
      });
    }
    
    return res.json({ 
      token: generateToken(user) 
    });
  }
}
```

### Padr√£o de Resposta Condicional

```typescript
import { Controller, Get, Query, Headers, Res } from "azurajs/decorators";

@Controller("/api/data")
export class DataController {
  @Get("/export")
  exportData(
    @Query("format") format: string,
    @Headers("accept") accept: string,
    @Res() res: ResponseServer
  ) {
    const data = getExportData();
    
    // Determinar formato de query ou cabe√ßalho Accept
    const outputFormat = format || 
      (accept?.includes('application/json') ? 'json' : 'csv');
    
    switch (outputFormat) {
      case 'json':
        return res
          .setHeader('Content-Type', 'application/json')
          .json(data);
      
      case 'csv':
        const csv = convertToCSV(data);
        return res
          .setHeader('Content-Type', 'text/csv')
          .setHeader('Content-Disposition', 'attachment; filename=export.csv')
          .send(csv);
      
      case 'xml':
        const xml = convertToXML(data);
        return res
          .setHeader('Content-Type', 'application/xml')
          .send(xml);
      
      default:
        return res.status(400).json({ 
          error: `Formato n√£o suportado: ${outputFormat}` 
        });
    }
  }
}
```

### Padr√£o de Recurso Aninhado

```typescript
import { Controller, Get, Post, Delete, Param, Body, Query } from "azurajs/decorators";

// Coment√°rios para um post espec√≠fico
@Controller("/api/posts/:postId/comments")
export class PostCommentController {
  @Get()
  getComments(
    @Param("postId") postId: string,
    @Query("page") page?: string,
    @Query("limit") limit?: string
  ) {
    const pageNum = Number(page) || 1;
    const limitNum = Number(limit) || 20;
    
    const comments = getCommentsForPost(postId, pageNum, limitNum);
    return { 
      postId, 
      comments,
      page: pageNum,
      limit: limitNum
    };
  }

  @Post()
  createComment(
    @Param("postId") postId: string,
    @Body() data: { text: string; authorId: string }
  ) {
    const comment = createComment({
      postId,
      text: data.text,
      authorId: data.authorId
    });
    
    return { comment };
  }

  @Delete("/:commentId")
  deleteComment(
    @Param("postId") postId: string,
    @Param("commentId") commentId: string
  ) {
    deleteComment(postId, commentId);
    return { message: "Coment√°rio deletado" };
  }
}
```

## Custom Decorators üé®

### Criando um Custom Decorator

Voc√™ pode criar custom decorators para l√≥gica reutiliz√°vel:

```typescript
import { Headers, Res } from "azurajs/decorators";
import type { ResponseServer } from "azurajs";

// Custom decorator para extrair e verificar JWT
function Auth() {
  return function (target: any, propertyKey: string, parameterIndex: number) {
    // Armazenar metadata para processamento
    const existingAuth = Reflect.getMetadata('auth_params', target, propertyKey) || [];
    existingAuth.push(parameterIndex);
    Reflect.defineMetadata('auth_params', existingAuth, target, propertyKey);
  };
}

// Uso seria assim:
@Controller("/api/protected")
export class ProtectedController {
  @Get("/data")
  getData(
    @Headers("authorization") auth: string,
    @Res() res: ResponseServer
  ) {
    // Verifica√ß√£o manual de auth
    if (!auth) {
      return res.status(401).json({ error: "N√£o autorizado" });
    }
    
    const token = auth.replace('Bearer ', '');
    const user = verifyJWT(token);
    
    if (!user) {
      return res.status(401).json({ error: "Token inv√°lido" });
    }
    
    return { data: "dados protegidos", user };
  }
}
```

### Padr√£o Pr√°tico de Custom Decorator

Para l√≥gica de autentica√ß√£o reutiliz√°vel:

```typescript
import { Controller, Get, Headers, Res } from "azurajs/decorators";

// Fun√ß√£o auxiliar (n√£o um decorator, mas reutiliz√°vel)
function requireAuth(token: string, res: ResponseServer): User | null {
  if (!token) {
    res.status(401).json({ error: "Sem token de autoriza√ß√£o" });
    return null;
  }
  
  const user = verifyToken(token);
  
  if (!user) {
    res.status(401).json({ error: "Token inv√°lido" });
    return null;
  }
  
  return user;
}

@Controller("/api/profile")
export class ProfileController {
  @Get("/me")
  getProfile(
    @Headers("authorization") auth: string,
    @Res() res: ResponseServer
  ) {
    const user = requireAuth(auth, res);
    if (!user) return; // Resposta j√° enviada
    
    return { profile: getUserProfile(user.id) };
  }
  
  @Get("/settings")
  getSettings(
    @Headers("authorization") auth: string,
    @Res() res: ResponseServer
  ) {
    const user = requireAuth(auth, res);
    if (!user) return;
    
    return { settings: getUserSettings(user.id) };
  }
}
```

## Decorators vs API Funcional ‚öñÔ∏è

### Quando Usar Decorators

‚úÖ **Melhor para:**
- Projetos TypeScript
- Aplica√ß√µes grandes com muitas rotas
- Equipes familiarizadas com padr√µes OOP
- Projetos que requerem forte seguran√ßa de tipos
- Aplica√ß√µes complexas com cadeias de middleware

```typescript
// Abordagem com decorators - Limpo e organizado
@Controller("/api/users")
export class UserController {
  @Get()
  list() { return { users: [] }; }
  
  @Get("/:id")
  show(@Param("id") id: string) { return { id }; }
  
  @Post()
  create(@Body() data: any) { return { data }; }
}
```

### Quando Usar API Funcional

‚úÖ **Melhor para:**
- Projetos JavaScript
- Aplica√ß√µes pequenas ou prot√≥tipos
- Microservi√ßos
- Equipes familiarizadas com Express.js
- Scripts r√°pidos e utilit√°rios

```javascript
// Abordagem funcional - Simples e direto
const app = new AzuraClient();

app.get("/api/users", ({ req, res }) => {
  res.json({ users: [] });
});

app.get("/api/users/:id", ({ req, res }) => {
  res.json({ id: req.params.id });
});

app.post("/api/users", ({ req, res }) => {
  res.json({ data: req.body });
});
```

### Compara√ß√£o de Recursos

| Recurso | Decorators | Funcional |
|---------|------------|------------|
| TypeScript necess√°rio | ‚úÖ Sim | ‚ùå N√£o |
| Seguran√ßa de tipos | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê |
| Curva de aprendizado | M√©dia | Baixa |
| Organiza√ß√£o de c√≥digo | Excelente | Boa |
| Boilerplate | Baixo | Muito baixo |
| Flexibilidade | Alta | Muito alta |
| Testes | F√°cil | Muito f√°cil |
| Manuten√ß√£o | Excelente | Boa |

### Misturando Ambas as Abordagens

Voc√™ pode combinar ambas na mesma aplica√ß√£o:

```typescript
import { AzuraClient } from "azurajs";
import { applyDecorators } from "azurajs/decorators";
import { UserController } from "./controllers/UserController";

const app = new AzuraClient();

// Use decorators para API principal
applyDecorators(app, [UserController]);

// Use API funcional para rotas simples
app.get("/health", ({ req, res }) => {
  res.json({ status: "ok" });
});

app.get("/version", ({ req, res }) => {
  res.json({ version: "1.0.0" });
});

app.listen(3000);
```

## Considera√ß√µes de Performance ‚ö°

### 1. Overhead de Decorators

Decorators adicionam overhead m√≠nimo em runtime:

```typescript
// ‚úÖ Bom: Decorators s√£o processados uma vez na inicializa√ß√£o
@Controller("/api/users")
export class UserController {
  @Get("/:id")
  getUser(@Param("id") id: string) {
    return { id };
  }
}

// Sem diferen√ßa de performance no tempo de requisi√ß√£o
```

### 2. Otimiza√ß√£o de Extra√ß√£o de Par√¢metros

```typescript
// ‚úÖ √ìtimo: Extraia apenas o que voc√™ precisa
@Get("/:id")
getUser(@Param("id") id: string) {
  return getUserById(id);
}

// ‚ùå Menos √≥timo: Extrair tudo
@Get("/:id")
getUser(
  @Req() req: RequestServer,
  @Res() res: ResponseServer,
  @Param() params: any,
  @Query() query: any,
  @Headers() headers: any
) {
  // Usando apenas params.id
  return getUserById(params.id);
}
```

### 3. Manipula√ß√£o de Resposta

```typescript
// ‚úÖ R√°pido: Retorno direto (JSON autom√°tico)
@Get("/users")
getUsers() {
  return { users: [] };
}

// ‚úÖ Tamb√©m r√°pido: Resposta manual
@Get("/users")
getUsers(@Res() res: ResponseServer) {
  return res.json({ users: [] });
}

// ‚ùå Evite: async desnecess√°rio quando n√£o necess√°rio
@Get("/users")
async getUsers() {  // N√£o use async se n√£o houver await
  return { users: [] };
}
```

### 4. Reutiliza√ß√£o de Inst√¢ncias de Classe

```typescript
// ‚úÖ Bom: Inst√¢ncias de controller s√£o reutilizadas
@Controller("/api/users")
export class UserController {
  // Propriedades de inst√¢ncia s√£o compartilhadas entre requisi√ß√µes
  private cache = new Map();
  
  @Get("/:id")
  getUser(@Param("id") id: string) {
    // Verificar cache
    if (this.cache.has(id)) {
      return this.cache.get(id);
    }
    
    const user = getUserFromDB(id);
    this.cache.set(id, user);
    return user;
  }
}
```

### 5. Evite Decorators Pesados

```typescript
// ‚ùå Evite: Computa√ß√£o pesada em decorators
function SlowDecorator() {
  // Isso roda na inicializa√ß√£o, ent√£o √© ok
  const config = loadHeavyConfig();
  return function(target: any) {
    // Mas n√£o fa√ßa trabalho pesado aqui em cada requisi√ß√£o
  };
}

// ‚úÖ Bom: Mantenha decorators leves
function FastDecorator() {
  return function(target: any) {
    // L√≥gica m√≠nima
  };
}
```

## Melhores Pr√°ticas ‚ú®

### 1. Use DTOs para Seguran√ßa de Tipos

```typescript
// Defina interfaces claras
interface CreateUserDto {
  email: string;
  password: string;
  name: string;
}

interface UpdateUserDto {
  email?: string;
  name?: string;
}

@Controller("/api/users")
export class UserController {
  @Post()
  create(@Body() data: CreateUserDto) {
    // TypeScript garante que data tem campos obrigat√≥rios
    return createUser(data);
  }
  
  @Patch("/:id")
  update(
    @Param("id") id: string,
    @Body() data: UpdateUserDto
  ) {
    // TypeScript sabe que campos s√£o opcionais
    return updateUser(id, data);
  }
}
```

### 2. Organize Controllers por Recurso

```typescript
// ‚úÖ Bom: Um controller por recurso
@Controller("/api/users")
export class UserController {}

@Controller("/api/posts")
export class PostController {}

@Controller("/api/comments")
export class CommentController {}

// ‚ùå Evite: Misturar m√∫ltiplos recursos
@Controller("/api")
export class ApiController {
  @Get("/users")
  @Get("/posts")
  @Get("/comments")
  // Muitas preocupa√ß√µes em um controller
}
```

### 3. Mantenha M√©todos Focados

```typescript
// ‚úÖ Bom: Cada m√©todo faz uma coisa
@Controller("/api/users")
export class UserController {
  @Get("/:id")
  getUser(@Param("id") id: string) {
    return getUserById(id);
  }
  
  @Get("/:id/posts")
  getUserPosts(@Param("id") id: string) {
    return getPostsByUser(id);
  }
}

// ‚ùå Evite: M√©todos fazendo demais
@Get("/:id")
getUser(
  @Param("id") id: string,
  @Query("include") include: string
) {
  const user = getUserById(id);
  
  if (include === 'posts') {
    user.posts = getPostsByUser(id);
  }
  if (include === 'comments') {
    user.comments = getCommentsByUser(id);
  }
  // Muita l√≥gica em um m√©todo
  
  return user;
}
```

### 4. Use Tipos Expl√≠citos

```typescript
// ‚úÖ Bom: Tipos expl√≠citos
@Get("/:id")
getUser(@Param("id") id: string): User {
  return getUserById(id);
}

// ‚ùå Evite: any impl√≠cito
@Get("/:id")
getUser(@Param("id") id) {  // id √© 'any'
  return getUserById(id);
}
```

### 5. Trate Erros Adequadamente

```typescript
import { Controller, Get, Param, Res } from "azurajs/decorators";

@Controller("/api/users")
export class UserController {
  @Get("/:id")
  getUser(
    @Param("id") id: string,
    @Res() res: ResponseServer
  ) {
    try {
      const user = getUserById(id);
      
      if (!user) {
        return res.status(404).json({ 
          error: "Usu√°rio n√£o encontrado" 
        });
      }
      
      return res.json({ user });
    } catch (error) {
      console.error('Erro ao buscar usu√°rio:', error);
      return res.status(500).json({ 
        error: "Erro interno do servidor" 
      });
    }
  }
}
```

## Troubleshooting Comum üîß

### Decorators N√£o Funcionando

**Problema**: Decorators n√£o sendo reconhecidos

```typescript
// ‚ùå Problema: N√£o aplicando decorators
import { UserController } from "./controllers/UserController";

const app = new AzuraClient();
// Rotas n√£o registradas!

// ‚úÖ Solu√ß√£o: Aplicar decorators
import { applyDecorators } from "azurajs/decorators";

const app = new AzuraClient();
applyDecorators(app, [UserController]);
```

### Par√¢metro N√£o Extra√≠do

**Problema**: Decorators de par√¢metro retornando undefined

```typescript
// ‚ùå Problema: Nome de par√¢metro errado
@Get("/users/:userId")
getUser(@Param("id") id: string) {  // Procurando 'id' mas rota tem 'userId'
  console.log(id); // undefined
}

// ‚úÖ Solu√ß√£o: Corresponder nomes de par√¢metros
@Get("/users/:userId")
getUser(@Param("userId") userId: string) {
  console.log(userId); // Funciona!
}
```

### Erros do Compilador TypeScript

**Problema**: Erros de decorator no TypeScript

```json
// tsconfig.json - Configura√ß√µes necess√°rias
{
  "compilerOptions": {
    "experimentalDecorators": true,
    "emitDecoratorMetadata": true,
    "target": "ES2017",
    "module": "commonjs"
  }
}
```

### Body N√£o Parseado

**Problema**: `@Body()` retorna undefined

```typescript
// ‚ùå Problema: Parser de body faltando ou Content-Type errado
@Post("/users")
createUser(@Body() data: any) {
  console.log(data); // undefined
}

// ‚úÖ Solu√ß√£o: Garantir que cliente envia Content-Type correto
// Lado do cliente:
fetch('/api/users', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'  // Importante!
  },
  body: JSON.stringify({ name: 'John' })
});
```

### Resposta Enviada Duas Vezes

**Problema**: N√£o √© poss√≠vel definir cabe√ßalhos ap√≥s serem enviados

```typescript
// ‚ùå Problema: Retornando valor E enviando resposta
@Get("/users")
getUsers(@Res() res: ResponseServer) {
  res.json({ users: [] });
  return { users: [] };  // N√£o fa√ßa isso!
}

// ‚úÖ Solu√ß√£o: Escolha uma abordagem
@Get("/users")
getUsers(@Res() res: ResponseServer) {
  return res.json({ users: [] });
  // OU apenas: res.json({ users: [] }); sem return
}

// ‚úÖ Ou deixe AzuraJS lidar com a resposta
@Get("/users")
getUsers() {
  return { users: [] };  // Resposta JSON autom√°tica
}
```

### Controller N√£o Encontrado

**Problema**: 404 para todas as rotas do controller

```typescript
// ‚ùå Problema: Esqueceu de exportar ou importar
export class UserController {}  // N√£o exportado com @Controller

// ‚úÖ Solu√ß√£o: Use decorator @Controller
@Controller("/api/users")
export class UserController {}

// E importar/aplicar
import { UserController } from "./controllers/UserController";
applyDecorators(app, [UserController]);
```

## Pr√≥ximos Passos üìñ

<Cards>
  <Card title="Routing" href="routing" description="Aprenda sobre padr√µes avan√ßados de rota" />
  <Card title="Valida√ß√£o" href="validation" description="Valide par√¢metros de decorators" />
  <Card title="Middleware" href="middleware" description="Use middleware com decorators" />
  <Card title="Exemplos" href="examples" description="Veja exemplos do mundo real" />
</Cards>
