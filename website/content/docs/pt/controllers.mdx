---
title: Controllers
description: Aprenda sobre o padr√£o controller no AzuraJS
icon: Target
---

# Controllers üéØ

Controllers s√£o o cora√ß√£o das aplica√ß√µes AzuraJS. Eles organizam seus manipuladores de rota em classes l√≥gicas e reutiliz√°veis usando decorators TypeScript.

## O que √© um Controller? üìö

Um controller √© uma classe decorada com `@Controller` que agrupa manipuladores de rota relacionados. Cada m√©todo no controller manipula uma rota espec√≠fica.

```typescript
import { Controller, Get, Post } from "azurajs/decorators";

@Controller("/api/products")
export class ProductController {
  
  @Get()
  getAllProducts() {
    return { products: [] };
  }

  @Post()
  createProduct() {
    return { message: "Produto criado" };
  }
}
```

## Decorator Controller üè∑Ô∏è

O decorator `@Controller` define um caminho base para todas as rotas no controller.

### Uso B√°sico

```typescript
@Controller("/api/users")
export class UserController {
  // Rotas ser√£o prefixadas com /api/users
}
```

### Sem Prefixo

```typescript
@Controller()  // Sem prefixo
export class RootController {
  @Get("/health")  // Rota: /health
  healthCheck() {
    return { status: "ok" };
  }
}
```

### Caminhos Aninhados

```typescript
@Controller("/api/v1/admin")
export class AdminController {
  @Get("/users")  // Rota: /api/v1/admin/users
  getUsers() {
    return { users: [] };
  }
}
```

## Criando Controllers üõ†Ô∏è

### Passo 1: Criar a Classe Controller

```typescript title="src/controllers/UserController.ts"
import { 
  Controller, 
  Get, 
  Post, 
  Put, 
  Delete,
  Body, 
  Param, 
  Res 
} from "azurajs/decorators";
import type { ResponseServer } from "azurajs/types";

@Controller("/api/users")
export class UserController {
  
  @Get()
  getAllUsers(@Res() res: ResponseServer) {
    res.json({ users: [] });
  }

  @Get("/:id")
  getUser(@Param("id") id: string, @Res() res: ResponseServer) {
    res.json({ id, name: `User ${id}` });
  }

  @Post()
  createUser(@Body() data: any, @Res() res: ResponseServer) {
    res.status(201).json({ id: Date.now(), ...data });
  }

  @Put("/:id")
  updateUser(
    @Param("id") id: string,
    @Body() data: any,
    @Res() res: ResponseServer
  ) {
    res.json({ id, ...data });
  }

  @Delete("/:id")
  deleteUser(@Param("id") id: string, @Res() res: ResponseServer) {
    res.json({ message: "Usu√°rio deletado" });
  }
}
```

### Passo 2: Registrar o Controller

```typescript title="src/index.ts"
import { AzuraClient } from "azurajs";
import { applyDecorators } from "azurajs/decorators";
import { UserController } from "./controllers/UserController";

const app = new AzuraClient();

// Registrar um √∫nico controller
applyDecorators(app, [UserController]);

await app.listen();
```

## M√∫ltiplos Controllers üì¶

Registre m√∫ltiplos controllers de uma vez:

```typescript title="src/index.ts"
import { AzuraClient } from "azurajs";
import { applyDecorators } from "azurajs/decorators";
import { UserController } from "./controllers/UserController";
import { ProductController } from "./controllers/ProductController";
import { AuthController } from "./controllers/AuthController";

const app = new AzuraClient();

applyDecorators(app, [
  UserController,
  ProductController,
  AuthController,
]);

await app.listen();
```

## Organiza√ß√£o de Controllers üìÅ

Organize controllers por funcionalidade ou recurso:

```
src/
‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îú‚îÄ‚îÄ index.ts
‚îÇ   ‚îú‚îÄ‚îÄ UserController.ts
‚îÇ   ‚îú‚îÄ‚îÄ ProductController.ts
‚îÇ   ‚îú‚îÄ‚îÄ OrderController.ts
‚îÇ   ‚îî‚îÄ‚îÄ AuthController.ts
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ UserService.ts
‚îÇ   ‚îî‚îÄ‚îÄ ProductService.ts
‚îî‚îÄ‚îÄ index.ts
```

Crie uma exporta√ß√£o barrel:

```typescript title="src/controllers/index.ts"
export { UserController } from "./UserController";
export { ProductController } from "./ProductController";
export { OrderController } from "./OrderController";
export { AuthController } from "./AuthController";
```

Depois importe todos de uma vez:

```typescript title="src/index.ts"
import { AzuraClient } from "azurajs";
import { applyDecorators } from "azurajs/decorators";
import * as controllers from "./controllers";

const app = new AzuraClient();
applyDecorators(app, Object.values(controllers));
await app.listen();
```

## Melhores Pr√°ticas de Controllers ‚ú®

### 1. Responsabilidade √önica

Cada controller deve lidar com um recurso ou funcionalidade:

```typescript
// ‚úÖ Bom: Focado em usu√°rios
@Controller("/api/users")
export class UserController {
  @Get() getAll() {}
  @Post() create() {}
}

// ‚ùå Ruim: Responsabilidades misturadas
@Controller("/api")
export class ApiController {
  @Get("/users") getUsers() {}
  @Get("/products") getProducts() {}
  @Get("/orders") getOrders() {}
}
```

### 2. Use Services para L√≥gica de Neg√≥cio

Mantenha controllers enxutos delegando para services:

```typescript
// UserService.ts
export class UserService {
  async getAllUsers() {
    // L√≥gica de neg√≥cio aqui
    return await database.users.findMany();
  }

  async createUser(data: any) {
    // L√≥gica de valida√ß√£o e cria√ß√£o
    return await database.users.create(data);
  }
}

// UserController.ts
import { UserService } from "../services/UserService";

@Controller("/api/users")
export class UserController {
  private userService = new UserService();

  @Get()
  async getAllUsers(@Res() res: ResponseServer) {
    const users = await this.userService.getAllUsers();
    res.json({ users });
  }

  @Post()
  async createUser(@Body() data: any, @Res() res: ResponseServer) {
    const user = await this.userService.createUser(data);
    res.status(201).json({ user });
  }
}
```

### 3. Formato de Resposta Consistente

Use uma estrutura de resposta consistente:

```typescript
interface ApiResponse<T> {
  success: boolean;
  data?: T;
  error?: string;
  message?: string;
}

@Controller("/api/users")
export class UserController {
  @Get()
  getAll(@Res() res: ResponseServer) {
    res.json({
      success: true,
      data: users
    });
  }

  @Get("/:id")
  getOne(@Param("id") id: string, @Res() res: ResponseServer) {
    const user = users.find(u => u.id === id);
    
    if (!user) {
      return res.status(404).json({
        success: false,
        error: "Usu√°rio n√£o encontrado"
      });
    }
    
    res.json({
      success: true,
      data: user
    });
  }
}
```

### 4. Tratamento de Erros

Use blocos try-catch e respostas de erro consistentes:

```typescript
import { Controller, Post, Body, Res } from "azurajs/decorators";
import { HttpError } from "azurajs/http-error";
import type { ResponseServer } from "azurajs/types";

@Controller("/api/users")
export class UserController {
  @Post()
  async createUser(@Body() data: any, @Res() res: ResponseServer) {
    try {
      // Validar
      if (!data.email) {
        throw new HttpError(400, "Email √© obrigat√≥rio");
      }
      
      // Criar usu√°rio
      const user = await this.userService.createUser(data);
      
      res.status(201).json({
        success: true,
        data: user
      });
    } catch (error) {
      if (error instanceof HttpError) {
        res.status(error.status).json({
          success: false,
          error: error.message
        });
      } else {
        res.status(500).json({
          success: false,
          error: "Erro interno do servidor"
        });
      }
    }
  }
}
```

### 5. Seguran√ßa de Tipos

Use interfaces TypeScript para tipos de requisi√ß√£o/resposta:

```typescript
interface CreateUserDto {
  name: string;
  email: string;
  password: string;
}

interface User {
  id: number;
  name: string;
  email: string;
  createdAt: Date;
}

@Controller("/api/users")
export class UserController {
  @Post()
  async createUser(
    @Body() data: CreateUserDto, 
    @Res() res: ResponseServer
  ) {
    const user: User = await this.userService.createUser(data);
    res.status(201).json({ user });
  }
}
```

## Padr√µes Avan√ßados üöÄ

### Inje√ß√£o de Construtor

Use o construtor para injetar depend√™ncias:

```typescript
import { UserService } from "../services/UserService";
import { Logger } from "../utils/Logger";

@Controller("/api/users")
export class UserController {
  constructor(
    private userService: UserService,
    private logger: Logger
  ) {}

  @Get()
  async getAll(@Res() res: ResponseServer) {
    this.logger.info("Buscando todos os usu√°rios");
    const users = await this.userService.getAllUsers();
    res.json({ users });
  }
}
```

### M√©todos Compartilhados

Crie m√©todos compartilhados para opera√ß√µes comuns:

```typescript
@Controller("/api/users")
export class UserController {
  private userService = new UserService();

  private sendSuccess(res: ResponseServer, data: any, status = 200) {
    res.status(status).json({
      success: true,
      data
    });
  }

  private sendError(res: ResponseServer, message: string, status = 400) {
    res.status(status).json({
      success: false,
      error: message
    });
  }

  @Get()
  async getAll(@Res() res: ResponseServer) {
    const users = await this.userService.getAllUsers();
    this.sendSuccess(res, users);
  }

  @Post()
  async create(@Body() data: any, @Res() res: ResponseServer) {
    try {
      const user = await this.userService.createUser(data);
      this.sendSuccess(res, user, 201);
    } catch (error: any) {
      this.sendError(res, error.message, 400);
    }
  }
}
```

## Pr√≥ximos Passos üìñ

<Cards>
  <Card title="Routing" href="routing" description="Aprenda sobre padr√µes de rota e par√¢metros" />
  <Card title="Decorators" href="decorators" description="Domine todos os decorators dispon√≠veis" />
  <Card title="Middleware" href="middleware" description="Adicione middleware aos controllers" />
  <Card title="Valida√ß√£o" href="validation" description="Valide dados de requisi√ß√£o" />
</Cards>
