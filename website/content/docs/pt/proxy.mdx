---
title: Proxy
description: Sistema de proxy e reverse proxy no AzuraJS
---

import { Tab, Tabs } from 'fumadocs-ui/components/tabs';

## Sistema de Proxy

O AzuraJS oferece um sistema completo de proxy/reverse proxy para criar API Gateways, microsservi√ßos e muito mais. O sistema de proxy j√° vem inclu√≠do, n√£o precisa instalar nada adicional.

## Uso B√°sico

### Proxy Simples

<Tabs items={['JavaScript', 'TypeScript']}>
<Tab value="JavaScript">
```javascript
const { AzuraClient } = require('azurajs');

const app = new AzuraClient();

// Faz proxy de todas as requisi√ß√µes /api/* para http://localhost:4000
app.proxy('/api', 'http://localhost:4000', {
  pathRewrite: { '^/api': '' }
});

app.listen(3000);
```
</Tab>
<Tab value="TypeScript">
```typescript
import { AzuraClient } from 'azurajs';

const app = new AzuraClient();

// Faz proxy de todas as requisi√ß√µes /api/* para http://localhost:4000
app.proxy('/api', 'http://localhost:4000', {
  pathRewrite: { '^/api': '' }
});

app.listen(3000);
```
</Tab>
</Tabs>

**Exemplo de requisi√ß√£o:**
- Cliente faz: `GET http://localhost:3000/api/users`
- Proxy encaminha para: `GET http://localhost:4000/users`

### Com Path Rewrite

```javascript
app.proxy('/api/v1', 'http://localhost:4000', {
  pathRewrite: {
    '^/api/v1': '/api',  // Reescreve /api/v1 para /api
    '/old': '/new'        // Substitui /old por /new
  }
});
```

## Op√ß√µes do Proxy

### Interface ProxyOptions

```typescript
interface ProxyOptions {
  // URL do servidor de destino
  target: string;
  
  // Reescrever paths
  pathRewrite?: Record<string, string>;
  
  // Headers customizados
  headers?: Record<string, string>;
  
  // Timeout em ms (padr√£o: 30000)
  timeout?: number;
  
  // Seguir redirects
  followRedirects?: boolean;
  
  // Manter host original
  preserveHost?: boolean;
  
  // N√≠vel de log: "none" | "info" | "debug"
  logLevel?: string;
  
  // Callbacks
  onProxyReq?: (proxyReq, req) => void;
  onProxyRes?: (proxyRes, req, res) => void;
  onError?: (err, req, res) => void;
}
```

### Exemplo com Todas as Op√ß√µes

```javascript
app.proxy('/api', 'http://localhost:4000', {
  // Reescrever path
  pathRewrite: { '^/api': '' },
  
  // Headers customizados
  headers: {
    'X-Custom-Header': 'MyValue',
    'Authorization': 'Bearer token123'
  },
  
  // Timeout de 10 segundos
  timeout: 10000,
  
  // Log detalhado
  logLevel: 'debug',
  
  // Modificar requisi√ß√£o antes de enviar
  onProxyReq: (proxyReq, req) => {
    console.log(`Proxying ${req.method} ${req.url}`);
    proxyReq.setHeader('X-Request-ID', `req-${Date.now()}`);
  },
  
  // Modificar resposta antes de enviar ao cliente
  onProxyRes: (proxyRes, req, res) => {
    console.log(`Response status: ${proxyRes.statusCode}`);
  },
  
  // Tratamento de erros customizado
  onError: (err, req, res) => {
    console.error('Proxy error:', err);
    res.status(502).json({ error: 'Gateway Error' });
  }
});
```

## Casos de Uso

### API Gateway

Centralize todas as suas APIs em um √∫nico endpoint:

```javascript
const gateway = new AzuraClient();

// M√∫ltiplos servi√ßos
gateway.proxy('/users', 'http://localhost:4001');
gateway.proxy('/products', 'http://localhost:4002');
gateway.proxy('/orders', 'http://localhost:4003');

gateway.listen(3000);
```

**Acesso:**
- `/users/*` ‚Üí Servi√ßo de usu√°rios na porta 4001
- `/products/*` ‚Üí Servi√ßo de produtos na porta 4002
- `/orders/*` ‚Üí Servi√ßo de pedidos na porta 4003

### Proxy para APIs Externas

```javascript
// Proxy para GitHub API
app.proxy('/github', 'https://api.github.com', {
  pathRewrite: { '^/github': '' },
  headers: {
    'User-Agent': 'MyApp/1.0'
  }
});

// Acesse: http://localhost:3000/github/users/octocat
```

### Autentica√ß√£o no Gateway

```javascript
// Middleware de autentica√ß√£o
function authMiddleware({ req, res, next }) {
  const token = req.headers.authorization;
  
  if (!token) {
    return res.status(401).json({ error: 'Unauthorized' });
  }
  
  // Validar token
  if (!validateToken(token)) {
    return res.status(403).json({ error: 'Forbidden' });
  }
  
  next();
}

// Aplicar autentica√ß√£o antes do proxy
app.use('/api', authMiddleware);
app.proxy('/api', 'http://localhost:4000', {
  pathRewrite: { '^/api': '' }
});
```

### Microservi√ßos com Cache

```javascript
const cache = new Map();

function cacheMiddleware({ req, res, next }) {
  const key = req.url;
  
  if (cache.has(key)) {
    return res.json(cache.get(key));
  }
  
  const originalJson = res.json.bind(res);
  res.json = (data) => {
    cache.set(key, data);
    return originalJson(data);
  };
  
  next();
}

app.use('/api/posts', cacheMiddleware);
app.proxy('/api/posts', 'https://jsonplaceholder.typicode.com', {
  pathRewrite: { '^/api': '' }
});
```

## Tratamento de Erros

### Erros Comuns

```javascript
app.proxy('/api', 'http://localhost:4000', {
  onError: (err, req, res) => {
    if (err.code === 'ECONNREFUSED') {
      return res.status(503).json({ 
        error: 'Service Unavailable',
        message: 'O servi√ßo est√° temporariamente indispon√≠vel'
      });
    }
    
    if (err.code === 'ETIMEDOUT') {
      return res.status(504).json({ 
        error: 'Gateway Timeout',
        message: 'O servi√ßo demorou muito para responder'
      });
    }
    
    res.status(502).json({ 
      error: 'Bad Gateway',
      message: 'Erro ao processar a requisi√ß√£o'
    });
  }
});
```

## Load Balancing üîÑ

Distribua tr√°fego entre m√∫ltiplos servidores:

```javascript
const servers = [
  'http://localhost:4001',
  'http://localhost:4002',
  'http://localhost:4003'
];

let currentServer = 0;

function loadBalancer({ req, res, next }) {
  // Load balancing round-robin
  const target = servers[currentServer];
  currentServer = (currentServer + 1) % servers.length;
  
  req.proxyTarget = target;
  next();
}

app.use('/api', loadBalancer);
app.proxy('/api', (req) => req.proxyTarget, {
  pathRewrite: { '^/api': '' },
  onProxyReq: (proxyReq, req) => {
    console.log(`Roteando para: ${req.proxyTarget}`);
  }
});
```

### Health Check com Failover

```javascript
const servers = [
  { url: 'http://localhost:4001', healthy: true },
  { url: 'http://localhost:4002', healthy: true },
  { url: 'http://localhost:4003', healthy: true }
];

// Verificar sa√∫de dos servidores a cada 30 segundos
setInterval(async () => {
  for (const server of servers) {
    try {
      const response = await fetch(`${server.url}/health`);
      server.healthy = response.ok;
    } catch {
      server.healthy = false;
    }
  }
}, 30000);

function smartLoadBalancer({ req, res, next }) {
  const healthyServers = servers.filter(s => s.healthy);
  
  if (healthyServers.length === 0) {
    return res.status(503).json({ error: 'Nenhum servidor dispon√≠vel' });
  }
  
  // Escolher servidor saud√°vel aleat√≥rio
  const server = healthyServers[Math.floor(Math.random() * healthyServers.length)];
  req.proxyTarget = server.url;
  next();
}

app.use('/api', smartLoadBalancer);
app.proxy('/api', (req) => req.proxyTarget, {
  pathRewrite: { '^/api': '' }
});
```

## Proxy de WebSocket üîå

Fa√ßa proxy de conex√µes WebSocket:

```javascript
app.proxy('/ws', 'ws://localhost:4000', {
  ws: true,  // Habilita proxy de WebSocket
  onProxyReqWs: (proxyReq, req, socket) => {
    console.log('WebSocket proxied');
  },
  onError: (err, req, socket) => {
    console.error('Erro WebSocket:', err);
    socket.end();
  }
});
```

### Exemplo Completo de WebSocket

```javascript
import { AzuraClient } from 'azurajs';

const app = new AzuraClient();

// Endpoint HTTP
app.get('/status', ({ res }) => {
  res.json({ status: 'online' });
});

// Proxy WebSocket
app.proxy('/socket', 'ws://localhost:8080', {
  ws: true,
  pathRewrite: { '^/socket': '' },
  headers: {
    'X-Gateway': 'AzuraJS'
  }
});

await app.listen(3000);
```

## Exemplos Avan√ßados üöÄ

### Padr√£o Circuit Breaker

Proteja seu sistema de falhas em cascata:

```javascript
class CircuitBreaker {
  constructor(threshold = 5, timeout = 60000) {
    this.failureCount = 0;
    this.threshold = threshold;
    this.timeout = timeout;
    this.state = 'CLOSED'; // CLOSED, OPEN, HALF_OPEN
    this.nextAttempt = Date.now();
  }
  
  async call(fn) {
    if (this.state === 'OPEN') {
      if (Date.now() < this.nextAttempt) {
        throw new Error('Circuit breaker est√° ABERTO');
      }
      this.state = 'HALF_OPEN';
    }
    
    try {
      const result = await fn();
      this.onSuccess();
      return result;
    } catch (error) {
      this.onFailure();
      throw error;
    }
  }
  
  onSuccess() {
    this.failureCount = 0;
    this.state = 'CLOSED';
  }
  
  onFailure() {
    this.failureCount++;
    if (this.failureCount >= this.threshold) {
      this.state = 'OPEN';
      this.nextAttempt = Date.now() + this.timeout;
    }
  }
}

const breaker = new CircuitBreaker();

app.proxy('/api', 'http://localhost:4000', {
  pathRewrite: { '^/api': '' },
  onError: async (err, req, res) => {
    breaker.onFailure();
    
    if (breaker.state === 'OPEN') {
      return res.status(503).json({
        error: 'Servi√ßo temporariamente indispon√≠vel',
        retryAfter: Math.ceil((breaker.nextAttempt - Date.now()) / 1000)
      });
    }
    
    res.status(502).json({ error: 'Bad Gateway' });
  }
});
```

### Transforma√ß√£o de Request/Response

```javascript
app.proxy('/api', 'http://localhost:4000', {
  pathRewrite: { '^/api': '' },
  
  // Transformar requisi√ß√£o
  onProxyReq: (proxyReq, req) => {
    // Adicionar autentica√ß√£o
    proxyReq.setHeader('X-API-Key', process.env.API_KEY);
    
    // Adicionar ID de requisi√ß√£o para rastreamento
    const requestId = `req-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
    proxyReq.setHeader('X-Request-ID', requestId);
    req.requestId = requestId;
    
    // Transformar body se necess√°rio
    if (req.body) {
      const body = JSON.stringify({
        ...req.body,
        timestamp: new Date().toISOString(),
        source: 'api-gateway'
      });
      proxyReq.setHeader('Content-Length', Buffer.byteLength(body));
      proxyReq.write(body);
    }
  },
  
  // Transformar resposta
  onProxyRes: (proxyRes, req, res) => {
    let body = '';
    
    proxyRes.on('data', (chunk) => {
      body += chunk;
    });
    
    proxyRes.on('end', () => {
      try {
        const data = JSON.parse(body);
        
        // Adicionar metadados
        const transformed = {
          data,
          metadata: {
            requestId: req.requestId,
            timestamp: new Date().toISOString(),
            cached: false
          }
        };
        
        res.json(transformed);
      } catch {
        res.send(body);
      }
    });
  }
});
```

### Rate Limiting por Target

```javascript
import { rateLimit } from 'azurajs/rate-limit';

const limiters = {
  '/users': rateLimit({ windowMs: 60000, max: 100 }),
  '/products': rateLimit({ windowMs: 60000, max: 200 }),
  '/orders': rateLimit({ windowMs: 60000, max: 50 })
};

Object.entries(limiters).forEach(([path, limiter]) => {
  app.use(path, limiter);
  app.proxy(path, `http://localhost:4000${path}`, {
    pathRewrite: { [`^${path}`]: '' }
  });
});
```

### Service Discovery com Consul

```javascript
import Consul from 'consul';

const consul = new Consul();

async function getServiceUrl(serviceName) {
  const result = await consul.health.service({
    service: serviceName,
    passing: true
  });
  
  if (result.length === 0) {
    throw new Error(`Nenhuma inst√¢ncia saud√°vel de ${serviceName}`);
  }
  
  // Load balancing aleat√≥rio
  const instance = result[Math.floor(Math.random() * result.length)];
  return `http://${instance.Service.Address}:${instance.Service.Port}`;
}

app.use('/api/users', async (req, res, next) => {
  try {
    req.serviceUrl = await getServiceUrl('user-service');
    next();
  } catch (error) {
    res.status(503).json({ error: error.message });
  }
});

app.proxy('/api/users', (req) => req.serviceUrl, {
  pathRewrite: { '^/api/users': '' }
});
```

## Best Practices üìã

### 1. Sempre Defina Timeouts

```javascript
app.proxy('/api', 'http://localhost:4000', {
  timeout: 30000,  // 30 segundos
  onError: (err, req, res) => {
    if (err.code === 'ETIMEDOUT') {
      res.status(504).json({ error: 'Gateway Timeout' });
    }
  }
});
```

### 2. Implemente Tratamento de Erros Adequado

```javascript
app.proxy('/api', 'http://localhost:4000', {
  onError: (err, req, res) => {
    // Log para monitoramento
    console.error('[Erro Proxy]', {
      url: req.url,
      method: req.method,
      error: err.message,
      code: err.code,
      timestamp: new Date().toISOString()
    });
    
    // Retornar status apropriado
    const statusMap = {
      'ECONNREFUSED': 503,
      'ETIMEDOUT': 504,
      'ENOTFOUND': 502,
      'ECONNRESET': 502
    };
    
    const status = statusMap[err.code] || 502;
    res.status(status).json({
      error: 'Erro no Proxy',
      message: err.message
    });
  }
});
```

### 3. Use Path Rewriting Corretamente

```javascript
// ‚úÖ Bom - Remove prefixo
app.proxy('/api/v1', 'http://localhost:4000', {
  pathRewrite: { '^/api/v1': '' }
});

// ‚ùå Ruim - Regex incorreta
app.proxy('/api/v1', 'http://localhost:4000', {
  pathRewrite: { '/api/v1': '' }  // N√£o vai funcionar corretamente
});
```

### 4. Adicione Rastreamento de Requisi√ß√µes

```javascript
app.proxy('/api', 'http://localhost:4000', {
  onProxyReq: (proxyReq, req) => {
    const traceId = req.headers['x-trace-id'] || `trace-${Date.now()}`;
    proxyReq.setHeader('X-Trace-ID', traceId);
    proxyReq.setHeader('X-Forwarded-For', req.ip);
    proxyReq.setHeader('X-Real-IP', req.ip);
  }
});
```

### 5. Preserve Headers Originais Quando Necess√°rio

```javascript
app.proxy('/api', 'http://localhost:4000', {
  preserveHost: true,  // Mant√©m header Host original
  headers: {
    'X-Forwarded-Proto': 'https',
    'X-Forwarded-Port': '443'
  }
});
```

### 6. Lide com Payloads Grandes

```javascript
app.proxy('/upload', 'http://localhost:4000', {
  timeout: 120000,  // 2 minutos para uploads
  onProxyReq: (proxyReq, req) => {
    if (req.headers['content-length']) {
      const sizeMB = parseInt(req.headers['content-length']) / (1024 * 1024);
      if (sizeMB > 100) {
        throw new Error('Payload muito grande');
      }
    }
  }
});
```

## Troubleshooting üîß

### Problema: Conex√£o Recusada

**Sintomas:** Erros `ECONNREFUSED`

**Solu√ß√µes:**

```javascript
// 1. Verifique se o servi√ßo alvo est√° rodando
// 2. Verifique regras de firewall
// 3. Implemente l√≥gica de retry

let retries = 0;
const maxRetries = 3;

app.proxy('/api', 'http://localhost:4000', {
  onError: async (err, req, res) => {
    if (err.code === 'ECONNREFUSED' && retries < maxRetries) {
      retries++;
      console.log(`Tentativa ${retries}/${maxRetries}`);
      
      // Aguardar antes de tentar novamente
      await new Promise(resolve => setTimeout(resolve, 1000 * retries));
      
      // Tentar requisi√ß√£o novamente
      return; // Implementar l√≥gica de retry aqui
    }
    
    res.status(503).json({ error: 'Servi√ßo Indispon√≠vel' });
    retries = 0;
  }
});
```

### Problema: Erros de Timeout

**Sintomas:** Requisi√ß√µes dando timeout

**Solu√ß√µes:**

```javascript
// 1. Aumente o timeout para endpoints lentos
app.proxy('/api/reports', 'http://localhost:4000', {
  timeout: 60000,  // 60 segundos para relat√≥rios
});

// 2. Implemente caching
const cache = new Map();

app.use('/api', (req, res, next) => {
  const key = `${req.method}:${req.url}`;
  
  if (cache.has(key)) {
    const { data, timestamp } = cache.get(key);
    
    // Cache por 5 minutos
    if (Date.now() - timestamp < 300000) {
      return res.json(data);
    }
  }
  
  const originalJson = res.json.bind(res);
  res.json = (data) => {
    cache.set(key, { data, timestamp: Date.now() });
    return originalJson(data);
  };
  
  next();
});
```

### Problema: Path N√£o Est√° Sendo Reescrito Corretamente

**Sintomas:** Erros 404 em requisi√ß√µes proxied

**Solu√ß√µes:**

```javascript
// ‚úÖ Correto: Use regex com ^
app.proxy('/api/v1', 'http://localhost:4000', {
  pathRewrite: { '^/api/v1': '' },
  logLevel: 'debug'  // Habilitar logging para ver rewrites
});

// Teste o rewrite
// Entrada:  /api/v1/users
// Sa√≠da: /users ‚úì

// ‚ùå Incorreto: Sem ^
app.proxy('/api/v1', 'http://localhost:4000', {
  pathRewrite: { '/api/v1': '' }  // Pode n√£o funcionar corretamente
});
```

### Problema: Headers N√£o Sendo Encaminhados

**Sintomas:** Backend n√£o recebe headers esperados

**Solu√ß√µes:**

```javascript
app.proxy('/api', 'http://localhost:4000', {
  onProxyReq: (proxyReq, req) => {
    // Encaminhar todos os headers
    Object.keys(req.headers).forEach(key => {
      proxyReq.setHeader(key, req.headers[key]);
    });
    
    // Adicionar headers customizados
    proxyReq.setHeader('X-Forwarded-For', req.ip);
    proxyReq.setHeader('X-Forwarded-Proto', req.protocol);
    proxyReq.setHeader('X-Forwarded-Host', req.headers.host);
  }
});
```

### Problema: Problemas de CORS com Proxy

**Sintomas:** Erros de CORS no navegador

**Solu√ß√µes:**

```javascript
import { cors } from 'azurajs/cors';

// Aplicar CORS antes do proxy
app.use(cors({
  origin: '*',
  credentials: true
}));

app.proxy('/api', 'http://localhost:4000', {
  onProxyRes: (proxyRes, req, res) => {
    // Adicionar headers CORS na resposta do proxy
    res.setHeader('Access-Control-Allow-Origin', '*');
    res.setHeader('Access-Control-Allow-Credentials', 'true');
  }
});
```

### Problema: Body N√£o Sendo Proxied

**Sintomas:** Requisi√ß√µes POST/PUT perdem o body

**Solu√ß√µes:**

```javascript
// Certifique-se de que o body parser est√° habilitado
app.use(express.json());

app.proxy('/api', 'http://localhost:4000', {
  onProxyReq: (proxyReq, req) => {
    if (req.body) {
      const body = JSON.stringify(req.body);
      proxyReq.setHeader('Content-Type', 'application/json');
      proxyReq.setHeader('Content-Length', Buffer.byteLength(body));
      proxyReq.write(body);
    }
  }
});
```

### Problema: Memory Leaks com Proxies de Longa Dura√ß√£o

**Sintomas:** Uso de mem√≥ria cresce com o tempo

**Solu√ß√µes:**

```javascript
// 1. Implemente connection pooling
import http from 'http';

const agent = new http.Agent({
  keepAlive: true,
  maxSockets: 50,
  maxFreeSockets: 10,
  timeout: 60000
});

app.proxy('/api', 'http://localhost:4000', {
  agent,  // Use connection pooling
});

// 2. Limpe event listeners
app.proxy('/api', 'http://localhost:4000', {
  onProxyRes: (proxyRes, req, res) => {
    proxyRes.on('end', () => {
      // Limpeza
      proxyRes.removeAllListeners();
    });
  }
});
```

## Otimiza√ß√£o de Performance ‚ö°

### 1. Connection Pooling

```javascript
import http from 'http';

const agent = new http.Agent({
  keepAlive: true,
  keepAliveMsecs: 1000,
  maxSockets: 100,
  maxFreeSockets: 10
});

app.proxy('/api', 'http://localhost:4000', {
  agent
});
```

### 2. Compress√£o de Resposta

```javascript
import zlib from 'zlib';

app.proxy('/api', 'http://localhost:4000', {
  onProxyRes: (proxyRes, req, res) => {
    const acceptEncoding = req.headers['accept-encoding'] || '';
    
    if (acceptEncoding.includes('gzip')) {
      res.setHeader('Content-Encoding', 'gzip');
      proxyRes.pipe(zlib.createGzip()).pipe(res);
    } else {
      proxyRes.pipe(res);
    }
  }
});
```

### 3. Deduplica√ß√£o de Requisi√ß√µes

```javascript
const pendingRequests = new Map();

app.use('/api', async (req, res, next) => {
  const key = `${req.method}:${req.url}`;
  
  if (pendingRequests.has(key)) {
    // Aguardar requisi√ß√£o existente
    const result = await pendingRequests.get(key);
    return res.json(result);
  }
  
  // Criar promise para esta requisi√ß√£o
  const promise = new Promise((resolve, reject) => {
    const originalJson = res.json.bind(res);
    res.json = (data) => {
      resolve(data);
      pendingRequests.delete(key);
      return originalJson(data);
    };
  });
  
  pendingRequests.set(key, promise);
  next();
});
```

## Exemplos Completos üìö

### API Gateway Completo

```javascript
import { AzuraClient } from 'azurajs';
import { cors } from 'azurajs/cors';
import { rateLimit } from 'azurajs/rate-limit';

const app = new AzuraClient();

// Middleware global
app.use(cors());
app.use(rateLimit({ windowMs: 60000, max: 100 }));

// Middleware de autentica√ß√£o
const auth = ({ req, res, next }) => {
  const token = req.headers.authorization;
  if (!token) {
    return res.status(401).json({ error: 'N√£o autorizado' });
  }
  next();
};

// Health check
app.get('/health', ({ res }) => {
  res.json({ status: 'healthy' });
});

// Endpoints p√∫blicos
app.proxy('/api/public', 'http://localhost:4001', {
  pathRewrite: { '^/api/public': '' }
});

// Endpoints protegidos
app.use('/api/users', auth);
app.proxy('/api/users', 'http://localhost:4002', {
  pathRewrite: { '^/api/users': '' }
});

app.use('/api/orders', auth);
app.proxy('/api/orders', 'http://localhost:4003', {
  pathRewrite: { '^/api/orders': '' }
});

await app.listen(3000);
console.log('API Gateway rodando na porta 3000');
```

Veja exemplos completos em [examples/servers/proxy](https://github.com/azurajsjs/azurajs/tree/main/examples/servers/proxy):

- **simple.js** - Configura√ß√£o b√°sica de proxy
- **microservices.js** - Gateway para m√∫ltiplos servi√ßos
- **load-balancer.js** - Implementa√ß√£o de load balancing
- **circuit-breaker.js** - Padr√£o circuit breaker

## Tabela de Refer√™ncia üìä

| Op√ß√£o | Tipo | Padr√£o | Descri√ß√£o |
|-------|------|--------|-----------|
| `target` | `string` | Obrigat√≥rio | URL do servidor alvo |
| `pathRewrite` | `Record<string, string>` | `{}` | Regras de reescrita de path |
| `headers` | `Record<string, string>` | `{}` | Headers customizados a adicionar |
| `timeout` | `number` | `30000` | Timeout de requisi√ß√£o em ms |
| `followRedirects` | `boolean` | `true` | Seguir redirects HTTP |
| `preserveHost` | `boolean` | `false` | Manter header Host original |
| `ws` | `boolean` | `false` | Habilitar proxy de WebSocket |
| `logLevel` | `string` | `'none'` | N√≠vel de log: none, info, debug |
| `onProxyReq` | `function` | `null` | Modificar requisi√ß√£o antes do proxy |
| `onProxyRes` | `function` | `null` | Modificar resposta ap√≥s o proxy |
| `onError` | `function` | `null` | Tratamento customizado de erros |

## Pr√≥ximos Passos

- [Router com Prefix](/docs/pt/routing#router-com-prefix)
- [Middleware](/docs/pt/middleware)
- [Rate Limiting](/docs/pt/rate-limiting)
- [Configura√ß√£o de CORS](/docs/pt/cors)
