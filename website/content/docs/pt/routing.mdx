---
title: Routing
description: Aprenda sobre padrÃµes de rota, parÃ¢metros e correspondÃªncia
icon: Route
---

# Routing ğŸ›£ï¸

AzuraJS fornece um sistema de roteamento poderoso e flexÃ­vel. VocÃª pode usar decorators com TypeScript ou a API funcional com JavaScript.

## ReferÃªncia RÃ¡pida de MÃ©todos HTTP ğŸ“‹

| MÃ©todo | PropÃ³sito | Tem Body | Idempotente | Seguro | Uso Comum |
|--------|-----------|----------|-------------|--------|------------|
| GET | Ler recurso | âŒ | âœ… | âœ… | Buscar dados, listar itens |
| POST | Criar recurso | âœ… | âŒ | âŒ | Criar registros, enviar formulÃ¡rios |
| PUT | Atualizar (completo) | âœ… | âœ… | âŒ | Substituir recurso inteiro |
| PATCH | Atualizar (parcial) | âœ… | âŒ | âŒ | Modificar campos especÃ­ficos |
| DELETE | Remover recurso | âŒ | âœ… | âŒ | Deletar registros |
| HEAD | Apenas cabeÃ§alhos | âŒ | âœ… | âœ… | Verificar existÃªncia, metadados |
| OPTIONS | MÃ©todos permitidos | âŒ | âœ… | âœ… | Preflight CORS |

<Callout type="info">
  **Idempotente** significa que a mesma requisiÃ§Ã£o pode ser feita mÃºltiplas vezes sem alterar o resultado alÃ©m da primeira requisiÃ§Ã£o.
</Callout>

<Callout type="info">
  **Seguro** significa que o mÃ©todo nÃ£o modifica dados no servidor.
</Callout>

## BÃ¡sico de Rotas ğŸ“

### TypeScript

Rotas sÃ£o definidas usando decorators de mÃ©todo HTTP em mÃ©todos de controller:

```typescript
import { Controller, Get, Param } from "azurajs/decorators";

@Controller("/api/users")
export class UserController {
  @Get()  // Corresponde: GET /api/users
  getAllUsers() {}

  @Get("/:id")  // Corresponde: GET /api/users/123
  getUser(@Param("id") id: string) {}
}
```

### JavaScript

Rotas sÃ£o definidas usando mÃ©todos funcionais:

```javascript
const { AzuraClient } = require("azurajs");

const app = new AzuraClient();

app.get("/api/users", ({ req, res }) => {
  // GET /api/users
  res.json({ users: [] });
});

app.get("/api/users/:id", ({ req, res }) => {
  // GET /api/users/123
  const { id } = req.params;
  res.json({ id });
});
```

## Caminhos de Rota ğŸ—ºï¸

### Caminhos EstÃ¡ticos

#### TypeScript

```typescript
@Get("/users")  // CorrespondÃªncia exata apenas
getUsers() {}

@Get("/users/active")  // CorrespondÃªncia exata
getActiveUsers() {}
```

#### JavaScript

```javascript
app.get("/users", ({ req, res }) => {
  res.json({ users: [] });
});

app.get("/users/active", ({ req, res }) => {
  res.json({ activeUsers: [] });
});
```

### ParÃ¢metros DinÃ¢micos

Use `:paramName` para parÃ¢metros de rota:

#### TypeScript

```typescript
@Get("/:id")  // Corresponde /123, /abc, etc.
getOne(@Param("id") id: string) {}

@Get("/:userId/posts/:postId")  // MÃºltiplos parÃ¢metros
getPost(
  @Param("userId") userId: string,
  @Param("postId") postId: string
) {}
```

#### JavaScript

```javascript
app.get("/:id", ({ req, res }) => {
  const { id } = req.params;  // Corresponde /123, /abc, etc.
  res.json({ id });
});

app.get("/:userId/posts/:postId", ({ req, res }) => {
  const { userId, postId } = req.params;
  res.json({ userId, postId });
});
```

### ParÃ¢metros de Query

ParÃ¢metros de query nÃ£o fazem parte do caminho da rota:

#### TypeScript

```typescript
import { Get, Query } from "azurajs/decorators";

// Rota: GET /search
// URL: GET /search?q=john&limit=10
@Get("/search")
search(@Query("q") query: string, @Query("limit") limit: string) {
  return { query, limit };
}
```

#### JavaScript

```javascript
// Rota: GET /search
// URL: GET /search?q=john&limit=10
app.get("/search", ({ req, res }) => {
  const { q, limit } = req.query;
  res.json({ query: q, limit });
});
```

## PadrÃµes de Rota ğŸ¨

### Combinando EstÃ¡tico e DinÃ¢mico

```typescript
import { Controller, Get, Param } from "azurajs/decorators";

@Controller("/api")
export class ApiController {
  @Get("/users/:id/profile") // GET /api/users/123/profile
  getProfile(@Param("id") id: string) {}

  @Get("/posts/:id/comments/:commentId") // MÃºltiplos params
  getComment(@Param("id") postId: string, @Param("commentId") commentId: string) {}
}
```

### Rotas Aninhadas

```typescript
@Controller("/api/organizations")
export class OrgController {
  @Get("/:orgId/teams/:teamId/members")
  getMembers(@Param("orgId") orgId: string, @Param("teamId") teamId: string) {
    return { orgId, teamId };
  }
}
```

## Regras de CorrespondÃªncia de Rotas ğŸ¯

### CorrespondÃªncia Exata

```typescript
// Rota: /users
GET /users        // âœ… Corresponde
GET /users/       // âŒ NÃ£o corresponde (barra final)
GET /users/123    // âŒ NÃ£o corresponde
```

### CorrespondÃªncia de ParÃ¢metros

ParÃ¢metros de rota correspondem a qualquer valor naquele segmento:

```typescript
// Rota: /users/:id
GET /users/123         // âœ… Corresponde (id = "123")
GET /users/abc         // âœ… Corresponde (id = "abc")
GET /users/abc-123     // âœ… Corresponde (id = "abc-123")
GET /users/123/posts   // âŒ NÃ£o corresponde
GET /users/            // âŒ NÃ£o corresponde (segmento vazio)
```

### MÃºltiplos ParÃ¢metros

```typescript
// Rota: /:category/:id
GET /books/123         // âœ… Corresponde (category="books", id="123")
GET /users/john        // âœ… Corresponde (category="users", id="john")
GET /books/123/pages   // âŒ NÃ£o corresponde (segmento extra)
```

### Regras de PrecedÃªncia de Caminhos

1. **Caminhos estÃ¡ticos** tÃªm maior prioridade
2. **Caminhos com parÃ¢metros** sÃ£o verificados depois
3. **Caminhos mais longos** sÃ£o correspondidos antes dos mais curtos
4. **Ordem de registro** importa para rotas de mesmo tamanho

```typescript
@Controller("/api")
export class ApiController {
  // Ordem de prioridade (maior para menor):
  @Get("/users/admin")         // 1. EstÃ¡tico - correspondÃªncia exata
  @Get("/users/me")            // 2. EstÃ¡tico - correspondÃªncia exata
  @Get("/users/:id/profile")   // 3. Caminho mais longo com parÃ¢metro
  @Get("/users/:id")           // 4. Caminho mais curto com parÃ¢metro
}
```

## Wildcards e PadrÃµes AvanÃ§ados ğŸŒŸ

### Rotas Curinga

Rotas catch-all para requisiÃ§Ãµes nÃ£o correspondidas:

```typescript
@Controller()
export class CatchAllController {
  // Lida com todas as rotas nÃ£o correspondidas
  @Get("*")
  notFound(@Req() req: RequestServer, @Res() res: ResponseServer) {
    res.status(404).json({
      error: "NÃ£o Encontrado",
      path: req.url,
      message: `Rota ${req.url} nÃ£o existe`
    });
  }
}
```

### CorrespondÃªncia com ExtensÃµes de Arquivo

```typescript
// Corresponder rotas com extensÃµes de arquivo
@Get("/images/:filename")
serveImage(@Param("filename") filename: string) {
  // filename pode ser: "avatar.jpg", "logo.png", etc.
  return { filename };
}

// Extrair extensÃ£o no handler
@Get("/files/:name")
serveFile(@Param("name") name: string) {
  const ext = name.split('.').pop();
  return { name, extension: ext };
}
```

### PadrÃ£o de Segmentos Opcionais

```typescript
// Para tornar segmentos opcionais, crie mÃºltiplas rotas
@Get("/posts")
@Get("/posts/:id")
getPosts(@Param("id") id?: string) {
  if (id) {
    return { post: getPostById(id) };
  }
  return { posts: getAllPosts() };
}
```

### PadrÃµes Tipo Regex

```typescript
// Lidar com APIs versionadas
@Controller("/api/v1")
export class V1Controller {}

@Controller("/api/v2")
export class V2Controller {}

// IDs numÃ©ricos apenas (validar no handler)
@Get("/users/:id")
getUser(@Param("id") id: string) {
  if (!/^\d+$/.test(id)) {
    throw new HttpError(400, "ID deve ser numÃ©rico");
  }
  return { id };
}
```

## ManipulaÃ§Ã£o de Query String ğŸ”

### ParÃ¢metros de Query BÃ¡sicos

```typescript
// URL: /search?q=azura&limit=10&sort=desc
@Get("/search")
search(@Query() query: Record<string, string>) {
  // query = { q: "azura", limit: "10", sort: "desc" }
  return { query };
}
```

### ParÃ¢metros de Query Individuais

```typescript
@Get("/search")
search(
  @Query("q") searchTerm: string,
  @Query("limit") limit: string,
  @Query("offset") offset: string
) {
  return {
    searchTerm,
    limit: Number(limit) || 10,
    offset: Number(offset) || 0
  };
}
```

### Valores PadrÃ£o para ParÃ¢metros de Query

```typescript
@Get("/posts")
getPosts(
  @Query("page") page?: string,
  @Query("limit") limit?: string
) {
  const pageNum = Number(page) || 1;
  const limitNum = Number(limit) || 20;
  
  return {
    posts: [],
    page: pageNum,
    limit: limitNum
  };
}
```

### ParÃ¢metros de Query em Array

```typescript
// URL: /filter?tags=javascript&tags=typescript&tags=nodejs
@Get("/filter")
filter(@Query() query: Record<string, any>) {
  // Lidar com parÃ¢metros array
  const tags = Array.isArray(query.tags) 
    ? query.tags 
    : [query.tags];
  
  return { tags };
}
```

### Objetos de Query Complexos

```typescript
// URL: /search?filter[status]=active&filter[role]=admin&sort[by]=date&sort[order]=desc
@Get("/search")
search(@Query() query: Record<string, any>) {
  // Parsear parÃ¢metros de query aninhados
  const filters = {
    status: query['filter[status]'],
    role: query['filter[role]']
  };
  
  const sorting = {
    by: query['sort[by]'],
    order: query['sort[order]']
  };
  
  return { filters, sorting };
}
```

### ParÃ¢metros de Query Booleanos

```typescript
// URL: /products?available=true&featured=false
@Get("/products")
getProducts(
  @Query("available") available?: string,
  @Query("featured") featured?: string
) {
  const isAvailable = available === 'true';
  const isFeatured = featured === 'true';
  
  return {
    available: isAvailable,
    featured: isFeatured
  };
}
```

## Prioridade de Rotas âš¡

Rotas sÃ£o correspondidas na ordem em que sÃ£o registradas. Rotas mais especÃ­ficas devem ser definidas primeiro:

```typescript
@Controller("/api/users")
export class UserController {
  // âœ… Ordem correta
  @Get("/me") // Rota especÃ­fica primeiro
  getCurrentUser() {}

  @Get("/:id") // Rota genÃ©rica depois
  getUser(@Param("id") id: string) {}

  // âŒ Ordem errada
  @Get("/:id") // Isso corresponderia /me
  getUser2(@Param("id") id: string) {}

  @Get("/me") // Nunca alcanÃ§ado!
  getCurrentUser2() {}
}
```

## MÃ©todos HTTP ğŸ”§

Todos os mÃ©todos HTTP padrÃ£o sÃ£o suportados:

### TypeScript

```typescript
@Controller("/api/posts")
export class PostController {
  @Get()  // Ler todos
  getAll() {}

  @Get("/:id")  // Ler um
  getOne(@Param("id") id: string) {}

  @Post()  // Criar
  create(@Body() data: any) {}

  @Put("/:id")  // Atualizar (completo)
  update(@Param("id") id: string, @Body() data: any) {}

  @Patch("/:id")  // Atualizar (parcial)
  patch(@Param("id") id: string, @Body() data: any) {}

  @Delete("/:id")  // Deletar
  remove(@Param("id") id: string) {}

  @Head("/:id")  // Verificar existÃªncia
  exists(@Param("id") id: string, @Res() res: ResponseServer) {
    res.status(200).end();
  }

  @Options()  // Preflight CORS
  options(@Res() res: ResponseServer) {
    res.set("Allow", "GET, POST").end();
  }
}
```

### JavaScript

```javascript
// Ler todos
app.get("/api/posts", ({ req, res }) => {
  res.json({ posts: [] });
});

// Ler um
app.get("/api/posts/:id", ({ req, res }) => {
  const { id } = req.params;
  res.json({ id });
});

// Criar
app.post("/api/posts", ({ req, res }) => {
  const data = req.body;
  res.status(201).json({ data });
});

// Atualizar (completo)
app.put("/api/posts/:id", ({ req, res }) => {
  const { id } = req.params;
  const data = req.body;
  res.json({ id, data });
});

// Atualizar (parcial)
app.patch("/api/posts/:id", ({ req, res }) => {
  const { id } = req.params;
  const data = req.body;
  res.json({ id, data });
});

// Deletar
app.delete("/api/posts/:id", ({ req, res }) => {
  const { id } = req.params;
  res.status(204).send();
});

// Verificar existÃªncia
app.head("/api/posts/:id", ({ req, res }) => {
  res.status(200).end();
});

// Preflight CORS
app.options("/api/posts", ({ req, res }) => {
  res.set("Allow", "GET, POST").end();
});
```

## Rotas ProgramÃ¡ticas ğŸ”¨

VocÃª tambÃ©m pode definir rotas programaticamente sem decorators:

```typescript
const app = new AzuraClient();

app.get("/api/health", ({ req, res }) => {
  res.json({ status: "ok" });
});

app.post("/api/webhook", ({ req, res }) => {
  console.log("Webhook recebido:", req.body);
  res.status(200).send("OK");
});

app.put("/api/items/:id", ({ req, res }) => {
  res.json({ id: req.params.id });
});
```

## Helpers de Rota ğŸ› ï¸

### MÃºltiplas Rotas por MÃ©todo

```typescript
// NÃ£o suportado diretamente, mas vocÃª pode criar um wrapper
@Controller("/api/posts")
export class PostController {
  private getPostsLogic() {
    return { posts: [] };
  }

  @Get()
  getPosts() {
    return this.getPostsLogic();
  }

  @Get("/all")
  getAllPosts() {
    return this.getPostsLogic();
  }
}
```

### Grupos de Rotas

Use controllers para agrupar rotas relacionadas:

```typescript
// Rotas de autenticaÃ§Ã£o
@Controller("/auth")
export class AuthController {
  @Post("/login")
  login() {}

  @Post("/register")
  register() {}

  @Post("/logout")
  logout() {}
}

// Rotas de API pÃºblica
@Controller("/api/public")
export class PublicController {}

// Rotas de admin
@Controller("/api/admin")
export class AdminController {}
```

## Router com Prefix ğŸ¯

O AzuraJS permite criar routers modulares e montÃ¡-los com prefixos especÃ­ficos, facilitando a organizaÃ§Ã£o de rotas em aplicaÃ§Ãµes maiores.

### Exemplo BÃ¡sico

```javascript
const { AzuraClient, Router } = require("azurajs");

// Criar routers modulares
const aboutRouter = new Router();
aboutRouter.add("GET", "/", ({ req, res }) => {
  res.end("About Home");
});
aboutRouter.add("GET", "/team", ({ req, res }) => {
  res.end("Our Team");
});

const apiRouter = new Router();
apiRouter.add("GET", "/", ({ req, res }) => {
  res.json({ message: "API Home" });
});
apiRouter.add("GET", "/users", ({ req, res }) => {
  res.json({ users: [] });
});

// Montar routers com prefixos
const app = new AzuraClient();
app.use("/about", aboutRouter);
app.use("/api", apiRouter);

app.listen(3000);
```

### Rotas DisponÃ­veis

- `GET /about` â†’ "About Home"
- `GET /about/team` â†’ "Our Team"
- `GET /api` â†’ JSON com mensagem
- `GET /api/users` â†’ JSON com lista de usuÃ¡rios

### BenefÃ­cios

- **Modularidade**: Organize rotas relacionadas em mÃ³dulos separados
- **ReutilizaÃ§Ã£o**: Use o mesmo router em diferentes aplicaÃ§Ãµes
- **Manutenibilidade**: Facilita encontrar e modificar rotas especÃ­ficas
- **Escalabilidade**: Adicione novos mÃ³dulos sem modificar o cÃ³digo existente

### Exemplo Completo

Veja o exemplo completo em [examples/servers/router/prefix.js](https://github.com/azurajsjs/azurajs/tree/main/examples/servers/router/prefix.js)

## Roteamento RESTful ğŸ¯

Siga convenÃ§Ãµes REST para APIs baseadas em recursos:

```typescript
@Controller("/api/users")
export class UserController {
  @Get() // GET /api/users - Listar todos os usuÃ¡rios
  index() {}

  @Post() // POST /api/users - Criar usuÃ¡rio
  store(@Body() data: any) {}

  @Get("/:id") // GET /api/users/:id - Obter um usuÃ¡rio
  show(@Param("id") id: string) {}

  @Put("/:id") // PUT /api/users/:id - Atualizar usuÃ¡rio
  update(@Param("id") id: string, @Body() data: any) {}

  @Delete("/:id") // DELETE /api/users/:id - Deletar usuÃ¡rio
  destroy(@Param("id") id: string) {}
}
```

## Testando Rotas ğŸ§ª

Teste suas rotas:

```typescript
import { AzuraClient } from "azurajs";
import { applyDecorators } from "azurajs/decorators";
import { UserController } from "./controllers/UserController";

const app = new AzuraClient();
applyDecorators(app, [UserController]);

// Iniciar servidor
await app.listen(3000);

// Testar endpoints
const response = await fetch("http://localhost:3000/api/users/123");
const data = await response.json();
console.log(data);
```

## Casos de Uso Comuns ğŸ’¡

### PadrÃ£o de PaginaÃ§Ã£o

```typescript
@Get("/posts")
getPosts(
  @Query("page") page?: string,
  @Query("limit") limit?: string
) {
  const pageNum = Math.max(1, Number(page) || 1);
  const limitNum = Math.min(100, Number(limit) || 20);
  
  const offset = (pageNum - 1) * limitNum;
  const posts = getPostsFromDB(offset, limitNum);
  const total = getTotalPosts();
  
  return {
    data: posts,
    pagination: {
      page: pageNum,
      limit: limitNum,
      total,
      totalPages: Math.ceil(total / limitNum)
    }
  };
}
```

### PadrÃ£o de Busca e Filtro

```typescript
@Get("/products/search")
searchProducts(
  @Query("q") query?: string,
  @Query("category") category?: string,
  @Query("minPrice") minPrice?: string,
  @Query("maxPrice") maxPrice?: string,
  @Query("sort") sort?: string
) {
  const filters = {
    query: query || '',
    category: category || 'all',
    priceRange: {
      min: Number(minPrice) || 0,
      max: Number(maxPrice) || Infinity
    },
    sortBy: sort || 'relevance'
  };
  
  const products = searchProductsDB(filters);
  return { products, filters };
}
```

### Rota de Upload de Arquivo

```typescript
@Post("/upload")
async uploadFile(
  @Req() req: RequestServer,
  @Res() res: ResponseServer
) {
  const files = await parseMultipartForm(req);
  
  return res.json({
    message: "Arquivos enviados",
    files: files.map(f => ({
      name: f.name,
      size: f.size,
      url: `/uploads/${f.id}`
    }))
  });
}
```

### PadrÃ£o de Versionamento de API

```typescript
// VersÃ£o 1
@Controller("/api/v1/users")
export class UsersV1Controller {
  @Get()
  getUsers() {
    return { version: 1, users: [] };
  }
}

// VersÃ£o 2 com novos recursos
@Controller("/api/v2/users")
export class UsersV2Controller {
  @Get()
  getUsers(@Query("include") include?: string) {
    return {
      version: 2,
      users: [],
      included: include ? parseIncludes(include) : []
    };
  }
}
```

### PadrÃ£o de Soft Delete

```typescript
@Delete("/:id")
deleteUser(
  @Param("id") id: string,
  @Query("permanent") permanent?: string
) {
  if (permanent === 'true') {
    // Hard delete
    permanentlyDeleteUser(id);
    return { message: "UsuÃ¡rio deletado permanentemente" };
  }
  
  // Soft delete
  softDeleteUser(id);
  return { message: "UsuÃ¡rio deletado (recuperÃ¡vel)" };
}
```

### PadrÃ£o de OperaÃ§Ãµes em Lote

```typescript
@Post("/bulk")
bulkCreate(@Body() items: any[]) {
  if (!Array.isArray(items)) {
    throw new HttpError(400, "Esperado array de itens");
  }
  
  const created = items.map(item => createItem(item));
  return { created: created.length, items: created };
}

@Delete("/bulk")
bulkDelete(@Body() ids: string[]) {
  if (!Array.isArray(ids)) {
    throw new HttpError(400, "Esperado array de IDs");
  }
  
  const deleted = ids.filter(id => deleteItem(id));
  return { deleted: deleted.length, ids: deleted };
}
```

## Melhores PrÃ¡ticas de OrganizaÃ§Ã£o de Rotas âœ¨

### 1. ConvenÃ§Ãµes de Nomenclatura Consistentes

```typescript
// âœ… Bom: ConvenÃ§Ãµes RESTful
@Controller("/api/articles")
export class ArticleController {
  @Get()           // GET /api/articles - index/list
  @Post()          // POST /api/articles - store/create
  @Get("/:id")     // GET /api/articles/:id - show/read
  @Put("/:id")     // PUT /api/articles/:id - update/replace
  @Patch("/:id")   // PATCH /api/articles/:id - partial update
  @Delete("/:id")  // DELETE /api/articles/:id - destroy/delete
}

// âŒ Ruim: Nomenclatura inconsistente
@Get("/getArticle/:id")     // NÃ£o inclua o mÃ©todo no caminho
@Post("/article/new")        // Use substantivos no plural
@Delete("/removeArticle")    // NÃ£o use verbos em caminhos RESTful
```

### 2. Use Nomes de Recursos no Plural

```typescript
// âœ… Bom
/api/users
/api/posts
/api/comments

// âŒ Ruim
/api/user
/api/post
/api/comment
```

### 3. Mantenha Rotas Planas

```typescript
// âœ… Bom: MÃ¡ximo 2-3 nÃ­veis
/api/users/:userId/posts
/api/posts/:postId/comments

// âŒ Ruim: Muito aninhado
/api/organizations/:orgId/departments/:deptId/teams/:teamId/members/:memberId/tasks

// âœ… Melhor: Use parÃ¢metros de query ou endpoints separados
/api/tasks?memberId=123&teamId=456
/api/members/:memberId/tasks
```

### 4. Agrupe Rotas Relacionadas

```typescript
// Agrupar por recurso
@Controller("/api/auth")
export class AuthController {
  @Post("/login")
  @Post("/register")
  @Post("/logout")
  @Post("/refresh")
  @Get("/me")
}

@Controller("/api/users")
export class UserController {
  @Get()           // Listar
  @Post()          // Criar
  @Get("/:id")     // Ler
  @Put("/:id")     // Atualizar
  @Delete("/:id")  // Deletar
}
```

### 5. Rotas EspecÃ­ficas Primeiro

```typescript
@Controller("/api/users")
export class UserController {
  // âœ… Ordem correta
  @Get("/me")          // Mais especÃ­fica
  @Get("/active")
  @Get("/search")
  @Get("/:id")         // Mais genÃ©rica
  
  // âŒ Ordem errada
  @Get("/:id")         // Isso captura /me, /active, /search!
  @Get("/me")          // Nunca alcanÃ§ado
  @Get("/active")      // Nunca alcanÃ§ado
}
```

### 6. Use Sub-controllers para Recursos Complexos

```typescript
// Recurso principal
@Controller("/api/posts")
export class PostController {}

// Sub-recursos
@Controller("/api/posts/:postId/comments")
export class PostCommentController {
  @Get()
  getComments(@Param("postId") postId: string) {}
  
  @Post()
  createComment(@Param("postId") postId: string) {}
}

@Controller("/api/posts/:postId/likes")
export class PostLikeController {}
```

## Dicas de Performance âš¡

### 1. Ordem de Registro de Rotas

Registre rotas mais acessadas primeiro:

```typescript
// âœ… Bom: Rotas mais acessadas primeiro
@Get("/health")      // Health check (mais frequente)
@Get("/api/users")   // Endpoint de API comum
@Get("/:slug")       // Catch-all (menos frequente)
```

### 2. Evite PadrÃµes de Rota Complexos

```typescript
// âœ… RÃ¡pido: PadrÃµes simples
@Get("/users/:id")
@Get("/posts/:postId/comments/:commentId")

// âŒ Mais lento: ValidaÃ§Ã£o complexa nas rotas
@Get("/users/:id")   // NÃ£o valide formato de ID na rota
getUser(@Param("id") id: string) {
  // Valide aqui em vez disso
  if (!/^\d+$/.test(id)) {
    throw new HttpError(400, "ID invÃ¡lido");
  }
}
```

### 3. Use Rotas EstÃ¡ticas Quando PossÃ­vel

```typescript
// âœ… Mais rÃ¡pido: Rotas estÃ¡ticas
@Get("/api/status")
@Get("/api/health")
@Get("/api/version")

// âŒ Mais lento: Tudo dinÃ¢mico
@Get("/api/:action")
handleAction(@Param("action") action: string) {
  switch (action) {
    case 'status': return getStatus();
    case 'health': return getHealth();
    // ...
  }
}
```

### 4. Limite a ExtraÃ§Ã£o de ParÃ¢metros

```typescript
// âœ… Bom: Extraia apenas o que vocÃª precisa
@Get("/:id")
getUser(@Param("id") id: string) {}

// âŒ Menos eficiente: Extrair tudo
@Get("/:id")
getUser(
  @Param() params: any,
  @Query() query: any,
  @Headers() headers: any,
  @Req() req: any
) {
  // Usando apenas params.id
}
```

### 5. Cache de Metadados de Rota

```typescript
// Use decorators eficientemente
const commonMetadata = { /* ... */ };

@Controller("/api/cached")
export class CachedController {
  @Get("/data")
  @Cache(60) // Cache por 60 segundos
  getData() {
    return expensiveOperation();
  }
}
```

## Troubleshooting de Rotas ğŸ”§

### Rota NÃ£o Correspondendo

**Problema**: Rota nÃ£o corresponde Ã s URLs esperadas

```typescript
// âŒ Problema
@Get("/users/:id")      // Espera: /users/123
getUser() {}            // Mas URL Ã©: /api/users/123

// âœ… SoluÃ§Ã£o: Verifique o prefixo do controller
@Controller("/api")     // Adicione o prefixo faltante
export class UserController {
  @Get("/users/:id")    // Agora corresponde: /api/users/123
  getUser() {}
}
```

### ParÃ¢metros NÃ£o ExtraÃ­dos

**Problema**: ParÃ¢metros estÃ£o undefined

```typescript
// âŒ Problema
@Get("/users/:userId")                 // Rota tem :userId
getUser(@Param("id") id: string) {}    // Mas decorator usa "id"

// âœ… SoluÃ§Ã£o: Corresponda os nomes dos parÃ¢metros
@Get("/users/:userId")
getUser(@Param("userId") userId: string) {}

// Ou
@Get("/users/:id")
getUser(@Param("id") id: string) {}
```

### 404 para Rotas VÃ¡lidas

**Problema**: Recebendo 404 para rotas que deveriam existir

```typescript
// Verifique esses problemas:

// 1. Controller nÃ£o registrado
const app = new AzuraClient();
applyDecorators(app, [UserController]); // âœ… NÃ£o esqueÃ§a disso

// 2. MÃ©todo HTTP errado
GET /api/users     // âœ… Definido
POST /api/users    // âŒ NÃ£o definido

// 3. Ordem de rota
@Get("/:id")       // âŒ Isso captura /me
@Get("/me")        // âŒ Nunca alcanÃ§ado
```

### ParÃ¢metros de Query NÃ£o Funcionando

**Problema**: ParÃ¢metros de query estÃ£o undefined

```typescript
// âŒ Problema: Usando decorator errado
@Get("/search")
search(@Param("q") query: string) {}  // Param Ã© para :param, nÃ£o ?q=

// âœ… SoluÃ§Ã£o: Use decorator Query
@Get("/search")
search(@Query("q") query: string) {}  // Agora funciona com ?q=value
```

### Conflitos de Rota

**Problema**: Duas rotas correspondem Ã  mesma URL

```typescript
// âŒ Problema: Rotas ambÃ­guas
@Controller("/api")
export class Controller1 {
  @Get("/users/:id")
  getUser() {}        // Corresponde /api/users/123
}

@Controller("/api")
export class Controller2 {
  @Get("/users/:name")
  getUserByName() {}  // TambÃ©m corresponde /api/users/123 !
}

// âœ… SoluÃ§Ã£o: Use caminhos distintos
@Get("/users/by-name/:name")  // /api/users/by-name/john
getUserByName() {}

@Get("/users/:id")             // /api/users/123
getUser() {}
```

### Problemas com Barra Final

**Problema**: Rota funciona com ou sem barra final de forma inconsistente

```typescript
// Por padrÃ£o, barras finais importam
@Get("/users")     // Corresponde: /users
                   // NÃ£o corresponde: /users/

// Para lidar com ambos
function normalizeRoutes(app: AzuraClient) {
  app.use(({ req, res, next }) => {
    if (req.url !== '/' && req.url.endsWith('/')) {
      req.url = req.url.slice(0, -1);
    }
    next();
  });
}
```

### ParÃ¢metros ContÃªm Caracteres Especiais

**Problema**: ParÃ¢metros de rota com caracteres especiais quebram

```typescript
// URL: /users/john@example.com
@Get("/users/:email")
getUser(@Param("email") email: string) {
  // email pode ser cortado no @
}

// âœ… SoluÃ§Ã£o: Codifique parÃ¢metros de URL
// Lado do cliente:
const email = encodeURIComponent('john@example.com');
fetch(`/users/${email}`);

// Lado do servidor:
@Get("/users/:email")
getUser(@Param("email") email: string) {
  const decoded = decodeURIComponent(email);
  return { email: decoded };
}
```

### Dicas de Debug

```typescript
// Registre todas as rotas registradas na inicializaÃ§Ã£o
import { AzuraClient } from "azurajs";
import { applyDecorators } from "azurajs/decorators";

const app = new AzuraClient();

// Adicione middleware de debug
app.use(({ req, res, next }) => {
  console.log(`${req.method} ${req.url}`);
  console.log('Params:', req.params);
  console.log('Query:', req.query);
  next();
});

applyDecorators(app, [UserController, PostController]);

app.listen(3000, () => {
  console.log('Servidor iniciado');
  console.log('Testar rotas:');
  console.log('- GET http://localhost:3000/api/users');
  console.log('- GET http://localhost:3000/api/users/123');
});
```

## PrÃ³ximos Passos ğŸ“–

<Cards>
  <Card title="Decorators" href="decorators" description="Domine todos os decorators" />
  <Card title="Middleware" href="middleware" description="Adicione middleware Ã s rotas" />
  <Card title="ValidaÃ§Ã£o" href="validation" description="Valide parÃ¢metros de rota" />
</Cards>
